define(["controllers/controllers"],function(e){e.controller("guarder",["$rootScope","$scope","Core","Storage",function(e,t,n,r){e.fixStyles(),t.blacklist={},t.resetBlacklist=function(){t.blacklist={label:"",contactInfo:""}},t.blacklists={list:function(){e.statusBar.display("Getting the list of blacklisted numbers.."),n.groups.list().then(function(){n.connections.list().then(function(){e.statusBar.off(),t.blacklist={},n.factory.process()})})},block:function(){if(t.blacklist.label!==""||t.blacklist.contactInfo!=="")e.statusBar.display("Adding a blacklisted number.."),n.blacklists.save({contactInfo:t.blacklist.contactInfo,label:t.blacklist.label}).then(function(i){e.statusBar.off(),t.resetBlacklist();var s=angular.fromJson(r.get("connections"));s.push(i),r.add("connections",angular.toJson(s));var o=angular.fromJson(r.get("groups"));angular.forEach(o,function(t){t.id===e.data.blacklist.group.id&&t.contactInfoIds.push(i.id)}),r.add("groups",angular.toJson(o)),n.factory.process(),e.$broadcast("setView","guarder")})},allow:function(t){e.statusBar.display("Removing a blacklisted number.."),n.blacklists.remove(t).then(function(){e.statusBar.off(),n.factory.process()})}}}])});