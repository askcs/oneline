define(["modals/modals","config"],function(e,t){e.factory("User",["$resource","$q","$location","Storage","$rootScope",function(e,n,r,i,s){var o=e(),u=e(t.host+"/login",{},{process:{method:"GET",params:{username:"",password:""}}}),a=e(t.host+"/logout",{},{process:{method:"GET",params:{}}}),f=e(t.host+"/accounts/contactinfos/owner",{},{query:{method:"GET",params:{},isArray:!0},create:{method:"POST",params:{}},get:{method:"GET",params:{tag:""}}});return o.prototype.login=function(e,t){var r=n.defer();return u.process({username:e,password:t},function(e){angular.equals(e,[])?r.reject("Something went wrong with login!"):r.resolve(e)},function(e){r.resolve(e)}),r.promise},o.prototype.logout=function(){var e=n.defer();return a.process(null,function(t){e.resolve(t)},function(t){e.resolve({error:t})}),e.promise},o.prototype.owner={get:function(){return angular.fromJson(i.get("resources"))},set:function(e){i.add("resources",angular.toJson(e)),this.process(e)},process:function(e){if(e){var t={};angular.forEach(e,function(e){switch(e.contactInfoTag){case"Name":t.name=e.contactInfo;break;case"Phone":t.phone=e.contactInfo;break;case"Email":t.email=e.contactInfo;break;case"Address":t.address=e.contactInfo;break;case"PURCHASED_NUMBER":t.purchasedNumber=e.contactInfo}}),e[0]&&(t.id=e[0].ownerKey),s.app.resources=t}}},o.prototype.resources=function(){var e=n.defer();return f.query(null,function(t){angular.equals(t,[])?e.reject("User has no resources!"):(o.prototype.owner.set(t),e.resolve(t))},function(t){e.resolve({error:t})}),e.promise},new o}])});